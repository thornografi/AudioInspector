/* ══════════════════════════════════════════════════════════════════════
   AUDIO TREE v3 - Self-contained tree visualization component
   Dependencies: Global CSS variables from popup.css
   JS: audio-tree.js (measureTreeLabels)
   ══════════════════════════════════════════════════════════════════════ */

.audio-tree {
  font-family: var(--font-mono);
  font-size: 11px;
  line-height: 14px;  /* Tam piksel - subpixel label yuksekligi onleme */
  padding: 4px 0;
  --tree-color: var(--text-muted);
  --tree-unit: 16px;
  --tree-line: 1px;
}

.tree-node {
  position: relative;
}

/* Parent node'lar (root dahil) flex layout - block/flex tutarsizligini onler */
.tree-node.has-children {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

.tree-label {
  display: inline-block;
  position: relative;
  color: var(--text-primary);
  font-weight: 500;
  /* Label'i biraz yukselterek cizgilerden ayir */
  padding-left: 2px;
  height: 14px;  /* line-height ile ayni - flexbox subpixel onleme */
  /* Truncation - dar panelde taşma önleme */
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Label text - JS olcumu icin ayri element */
.tree-label-text {
  /* display: inline - varsayilan */
}

/* Param (parantez ici) - farkli stil */
.tree-param {
  color: var(--text-muted);
  font-weight: 400;
  margin-left: 4px;
}

/* Parent govdesi: label-text ortasindan asagi */
.tree-node.has-children > .tree-label::after {
  content: '';
  position: absolute;
  /* JS'ten gelen deger (measureTreeLabels), fallback: %50 */
  left: var(--stem-left, 50%);
  top: 100%;
  /* Border rendering: DPI tutarlılığı için (background yerine) */
  width: 0;
  height: var(--tree-unit);
  border-left: var(--tree-line) solid var(--tree-color);
}

/* Children container */
.tree-children {
  position: relative;
  padding-left: var(--tree-unit);
  padding-top: calc(var(--tree-unit) / 2);  /* Ustten bosluk - govde baglantisi icin */
  /* JavaScript'ten gelen gercek label genisligi (measureTreeLabels) */
  margin-left: var(--parent-center, 40px);
}

/* Dikey cizgi: JavaScript'ten gelen dinamik height */
.tree-children::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  /* JavaScript'ten hesaplanan deger, fallback: label height (14px) / 2 = 7px */
  height: var(--vertical-line-height, calc(100% - 7px));
  /* Border rendering: DPI tutarlılığı için */
  width: 0;
  border-left: var(--tree-line) solid var(--tree-color);
}

/* Yatay dal: dikey cizgiden child'a (label'in icine girmez) */
.tree-children > .tree-node::before {
  content: '';
  position: absolute;
  left: calc(-1 * var(--tree-unit));
  top: var(--horizontal-line-top, 7px);  /* JS ile senkronize - label height (14px) / 2 = 7px */
  /* Border rendering: DPI tutarlılığı için */
  width: var(--tree-unit);
  height: 0;
  border-top: var(--tree-line) solid var(--tree-color);
}

/* Child node layout - minimum yukseklik ile tutarli dikey cizgiler */
.tree-children > .tree-node {
  min-height: var(--tree-unit);
  display: flex;
  align-items: flex-start;
  flex-direction: column;
  /* padding-top kaldirildi - cizgi hesaplamasi JS'te yapiliyor (measureTreeLabels) */
}

/* Varyantlar */
.tree-node.tree-monitor .tree-label { color: var(--text-muted); }
.tree-label.has-tooltip { cursor: default; }

/* Audio Tree tooltip'leri: tooltip-left class'i ile yonetilir (popup.css) */
/* Ek stil gerekirse burada override edilebilir */
